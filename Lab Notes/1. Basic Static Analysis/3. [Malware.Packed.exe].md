# Malware.Packed.exe Analysis

The malware sample **Malware.Packed.exe** was started with static anaysis. For this, it was first opened with CFF Explorer tool.

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/bf4a57e3-a3fa-4041-8461-98bb91be8bb9)

-   Filetype **PE 32**
-   Fileinfo **UPX**
      - UPX is popular packer program
-   Original filename **ab.exe**
-   Hash:

  |Hash Function  | Hash Value|
  |--|--|
  |MD5| 60FF78514D6DF20C6E82B7B777151C5C
  |SHA-1|F7BC8BEB30E9673D8FC4F6363EAB07094ED35B59
  
<br>
<br>

Then, the File Header for this malware sample were checked.

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/8cc1b9fe-a868-4d88-924d-55966aaf1fdc)

- Compiled for **Intel 386**
- Has **3** Sections
- Compiled data **4A5B56A9** (epoch)
    - **GMT:** Monday, July 13, 2009 3:45:45 PM 

<br>
<br>

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/a8cce361-ddb3-4fb6-a7c0-74f4dd397539)

- - Entry point address is **0x17B30 (UPX)**
    - Further sign that program is packed with UPX
- The malware has a **Windows GUI** as verified from Subsystem.

<br>
<br>

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/693b511f-2915-42b5-b19a-2062f6d8c14b)

- Section name **UPX0** and **UPX1** made it obivous that it is packed with UPX
- Furthermore, the malware sample is probably packed because:
    -  The .text section (where executable code reside) has huge difference value between virtual size (size on memory) and raw size (size on disk).

<br>
<br>

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/9e6fddcf-9a07-45b5-b39c-36655b6a86da)

- Likewise, the entropy of this sample on checking with **Detect It Easily** tool supports that this malware sample was packed.

<br>
<br>

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/32ac12cd-fe73-4bb4-af66-d397bea62bee)

- The packed malware sample was unpacked using UPX tool and saved as **Malware.Unpacked.exe** as shown above. It was done with the command:
<br>

    upx -dqk -9 -o Malware.UnPacked.exe Malware.Packed.exe


<br>
<br>

![image](https://github.com/VenusChhantel/TCM-PMAT-Learnings/assets/122972953/ff5eec7a-e328-4b93-8449-dc74df6c69c0)

- On checking just unpacked executable **Malware.UnPacked.exe again in CFF Explorer, it was no longer packed and its sections was no longer visible as UPX.
    - Furthermore, .text section has relatively close virtual size and raw size.

***Now on the unpacked executable further analysis needs to be carried which will be covered in later samples***
